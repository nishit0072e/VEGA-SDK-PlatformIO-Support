; ============================================================
;  Aries V3 (CDAC THEJAS32 / VEGA ET1031 RV32IM) PlatformIO
; ============================================================
;
;  Build  : pio run
;  Upload : pio run --target upload --upload-port COM3
;           (change COM3 to whatever port your board appears on)
; ============================================================

[env:aries_v3]
; We use the 'native' platform purely as a shell — all real
; compiler/linker settings are overridden by extra_scripts.
platform = native
board     = aries_v3

; ---------- custom build script (compiles BSP, links everything) ----------
extra_scripts =
    pre:extra_scripts/build_vega.py
    post:extra_scripts/upload_vega.py

; Prevent PIO's native compiler from touching src/ — our script compiles everything
build_src_filter = -<*>

; ---------- REQUIRED PATHS (Edit these for your local setup) -----------
; You must provide absolute paths to your VEGA SDK, Toolchain, and Flasher.
vega_sdk_path   = G:/antigravity_proj/vega-sdk
vega_tools_path  = G:/antigravity_proj/vega-tools-windows/bin
vega_flasher_dir = G:/antigravity_proj/vega-flasher-windows

; ---------- upload via vega-flasher (flasher.bat) -----------------------
; Usage: flasher.bat <COM_PORT> <ELF_FILE>
; Positional args — no --port/--baud flags.
; Run: pio run --target upload --upload-port COM3
upload_protocol = custom
upload_command  = cmd /c "${this.vega_flasher_dir}/flasher.bat" $UPLOAD_PORT "$BUILD_DIR/firmware.elf"
